<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSTD-DOMINO System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="profile-container">
        <div id="profileCorner" class="profile-header" onclick="toggleMenu()">
            <span id="cornerUsername" class="profile-name">Гість</span>
            <div id="avatarCircle" class="avatar-circle">Г</div>
        </div>
        
        <div id="dropdownMenu" class="dropdown-content">
            <a onclick="showSection('main')">Головна</a>
            <a onclick="showSection('profile')">Профіль</a>
            <a onclick="showSection('news')">Новини</a>
            <a onclick="showSection('team')">Партія</a>
            <a onclick="showSection('tests')">Тести</a> 
            <a onclick="showSection('support')">Підтримка</a>
            <a id="adminBtn" onclick="showSection('admin')" style="display: none; color: red; font-weight: bold;">АА</a>
            <div class="divider"></div>
            <a onclick="handleLogout()" class="logout-btn">Вихід</a>
        </div>
    </div>

    <div id="loginSection" class="container">
        <h1>Вхід BSTD</h1>
        <input type="text" id="loginUser" placeholder="Логін">
        <input type="password" id="loginPass" placeholder="Пароль">
        <button id="btnLogin" onclick="performLogin()">Увійти</button>
        <div id="loginStatus" class="status-msg"></div>
        <p style="font-size: 0.9em;">Немає акаунту? <span class="text-link" onclick="showSection('register')">Зареєструватися</span></p>
    </div>

    <div id="registerSection" class="container hidden">
        <h1>Реєстрація</h1>
        <input type="text" id="regUser" placeholder="Придумайте логін">
        <input type="password" id="regPass" placeholder="Придумайте пароль">
        <button id="btnReg" onclick="performRegister()">Створити акаунт</button>
        <div id="regStatus" class="status-msg"></div>
        <p style="font-size: 0.9em;">Вже є акаунт? <span class="text-link" onclick="showSection('login')">Увійти</span></p>
    </div>

    <div id="mainSection" class="container hidden">
        <h1 id="welcomeText">Вітаємо!</h1>
        <div class="menu-grid">
            <button class="btn" onclick="showSection('news')">Новини</button>
            <button class="btn" onclick="showSection('profile')">Профіль</button>
            <button class="btn" onclick="showSection('team')">Партія</button>
            <button class="btn" onclick="showSection('support')">Підтримка</button>
        </div>
    </div>

    <div id="profileSection" class="container hidden" style="max-width: 700px;">
        <h2 style="font-size: 2em; margin-bottom: 20px;">Профіль <span id="profileNameHeader">User</span></h2>
        <div class="profile-layout">
            <div class="profile-left">
                <img src="https://via.placeholder.com/150" id="profileAvatarBig" alt="Avatar">
            </div>
            <div class="profile-right">
                <p><strong>Ім'я:</strong> <span id="profileName">User</span></p>
                <p><strong>Бали:</strong> <span id="profileScore">0</span></p>
                <p><strong>Партія:</strong> <span id="profileTeam">Не розподілено</span></p>
                <p><strong>Статус:</strong> <span style="color:green; font-weight:bold;">У системі</span></p>
                <div style="background: #f0f0f0; padding: 10px; border-radius: 8px; margin-top: 10px;">
                    <strong>Опис:</strong>
                    <p id="profileDescription" style="font-style: italic; color: #555;">(Немає опису)</p>
                </div>
            </div>
        </div>
        <br>
        <button onclick="showSection('main')" class="btn-back">На головну</button>
    </div>

    <div id="newsSection" class="container hidden" style="max-width: 600px;">
        <h2>Новини</h2>
        <div id="newsFeedContainer">
            <p>Завантаження новин...</p>
        </div>
        <br>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="newsReaderSection" class="container hidden" style="max-width: 700px; text-align: left;">
        <button onclick="showSection('news')" style="width: auto; padding: 5px 15px; margin-bottom: 10px; font-size: 0.9em;">До списку</button>
        <h1 id="readerTitle" style="margin-bottom: 5px;">Заголовок</h1>
        <h3 id="readerSubtitle" style="color: grey; margin-top: 0;">Підзаголовок</h3>
        <p style="font-size: 0.8em; color: #888;" id="readerDate">Дата</p>
        <hr>
        <div id="readerContent" style="margin-top: 20px; line-height: 1.6;">
            </div>
    </div>

    <div id="adminSection" class="container hidden" style="border: 2px solid red;">
        <h2 style="color: red;">АА</h2>
        <div class="admin-tabs">
            <button onclick="document.getElementById('createTestForm').classList.toggle('hidden')">Конструктор Тестів</button>
            <br><br>
            <button onclick="loadUserManagement()" style="background: #333;">Всі Гості</button>
            <br><br>
            <button onclick="openNewsCreator()" style="background: #4f46e5;">Створити Новину</button>
        </div>

        <div id="createTestForm" class="hidden" style="text-align: left; margin-top: 15px;">
            <h3>Створити тест</h3>
            <label>Тип:</label><select id="newQType"><option value="mandatory">Обовязковий</option><option value="optional">Звичайний</option></select>
            <input type="text" id="newQText" placeholder="Текст...">
            <input type="file" id="newQFile" accept="image/*">
            <p id="uploadStatus" style="font-size: 0.8em; color: blue;"></p>
            <input type="hidden" id="uploadedImageUrl">
            <div id="answersContainer">
                <input type="text" class="ans-text" placeholder="Відп 1"><input type="number" class="ans-score" placeholder="Бал">
                <br><input type="text" class="ans-text" placeholder="Відп 2"><input type="number" class="ans-score" placeholder="Бал">
            </div>
            <button onclick="addAnswerField()" style="background: grey;">+ Ще</button>
            <hr>
            <button onclick="addToDraft()" style="background: orange;">Додати в список</button>
        </div>
        <div id="draftContainer" style="margin-top: 20px; border-top: 2px solid #ccc; padding-top: 10px;">
            <h3>Список питань:</h3><div id="draftList"><p>Пусто...</p></div>
            <button id="btnPublish" onclick="publishTest()" style="background: green; display: none;">ЗАВАНТАЖИТИ</button>
        </div>
        <br><button onclick="showSection('main')">Назад</button>
    </div>

    <div id="createNewsSection" class="container hidden" style="max-width: 700px; text-align: left;">
        <h2>Створення Новини</h2>
        
        <label>Хто бачить:</label>
        <select id="newsTargetType" onchange="toggleNewsTargetInput()">
            <option value="all">Всі</option>
            <option value="team">Конкретна партія</option>
            <option value="users">Конкретні люди</option>
        </select>
        <input type="text" id="newsTargetValue" placeholder="Назва партії або нікнейми через кому" style="display: none;">

        <label>Заголовок (Головний):</label>
        <input type="text" id="newsTitle" placeholder="Гучна назва...">
        
        <label>Підзаголовок:</label>
        <input type="text" id="newsSubtitle" placeholder="Короткий опис...">

        <label>Обкладинка (Перше фото в списку):</label>
        <input type="file" id="newsCoverFile" accept="image/*">
        <input type="hidden" id="newsCoverUrl">
        <p id="newsCoverStatus" style="font-size: 0.8em; color: blue;"></p>

        <hr>
        <h3>Контент (Текст + Фото)</h3>
        <div id="newsContentBuilder" style="border: 1px dashed #ccc; padding: 10px; min-height: 100px; margin-bottom: 10px;">
            <p style="color:grey; text-align:center;">Додайте блоки...</p>
        </div>

        <div style="display: flex; gap: 10px;">
            <button onclick="addNewsTextBlock()" style="background: #eee; color: black;">Текст</button>
            <button onclick="addNewsImageBlock()" style="background: #eee; color: black;">Фото</button>
        </div>

        <br><hr><br>
        <button onclick="publishNews()" style="background: green;">Опублікувати Новину</button>
        <br><br>
        <button onclick="showSection('admin')" style="background: grey;">Скасувати</button>
    </div>

    <div id="userListSection" class="container hidden" style="max-width: 600px;">
        <h2>Керування гостями</h2>
        <div id="allUsersContainer" style="text-align: left;"><p>Завантаження...</p></div>
        <br><button onclick="showSection('admin')">Назад</button>
    </div>

    <div id="testPlayerSection" class="container hidden" style="max-width: 500px;">
        <img id="testImage" style="width: 100%; max-height: 250px; object-fit: contain; display: none; margin-bottom: 15px; border-radius: 8px;" referrerpolicy="no-referrer">
        <h2 id="testQuestionText">Запитання...</h2>
        <div id="testAnswers" class="menu-grid"></div>
        <p style="font-size: 0.8em; color: grey; margin-top: 10px;">Питання <span id="qCurrent">0</span> з <span id="qTotal">0</span></p>
    </div>

    <div id="supportSection" class="container hidden">
        <h2>Підтримка</h2>
        <textarea id="supportMessage" placeholder="Ідея..." rows="5"></textarea>
        <button id="btnSupport" onclick="sendFeedback()">Відправити</button>
        <div id="supportStatus" class="status-msg"></div><br><br><button onclick="showSection('main')">Назад</button>
    </div>
    
    <div id="testsSection" class="container hidden"><h2>Доступні Тести</h2><div id="testsListContainer" class="menu-grid" style="grid-template-columns: 1fr;"><p>...</p></div><br><button onclick="showSection('main')">Назад</button></div>

    <script src="script.js"></script>
</body>
</html>

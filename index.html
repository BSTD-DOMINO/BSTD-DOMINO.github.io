<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSTD-DOMINO System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="profile-container">
        <div id="profileCorner" class="profile-header" onclick="toggleMenu()">
            <span id="cornerUsername" class="profile-name">Гість</span>
            <div id="avatarCircle" class="avatar-circle">Г</div>
        </div>
        
        <div id="dropdownMenu" class="dropdown-content">
            <a onclick="showSection('main')">Головна</a>
            <a onclick="showSection('profile')">Профіль</a>
            <a onclick="showSection('news')">Новини</a>
            <a onclick="showSection('team')">Партія</a>
            <a onclick="showSection('tests')">Тести</a> 
            <a onclick="showSection('support')">Підтримка / Ідея</a>
            <a id="adminBtn" onclick="showSection('admin')" style="display: none; color: red; font-weight: bold;">АА</a>
            <div class="divider"></div>
            <a onclick="handleLogout()" class="logout-btn">Вихід</a>
        </div>
    </div>

    <div id="loginSection" class="container">
        <h1>Вхід BSTD</h1>
        <input type="text" id="loginUser" placeholder="Логін">
        <input type="password" id="loginPass" placeholder="Пароль">
        <button id="btnLogin" onclick="performLogin()">Увійти</button>
        <div id="loginStatus" class="status-msg"></div>
        <p style="font-size: 0.9em;">Немає акаунту? <span class="text-link" onclick="showSection('register')">Зареєструватися</span></p>
    </div>

    <div id="registerSection" class="container hidden">
        <h1>Реєстрація</h1>
        <input type="text" id="regUser" placeholder="Придумайте логін">
        <input type="password" id="regPass" placeholder="Придумайте пароль">
        <button id="btnReg" onclick="performRegister()">Створити акаунт</button>
        <div id="regStatus" class="status-msg"></div>
        <p style="font-size: 0.9em;">Вже є акаунт? <span class="text-link" onclick="showSection('login')">Увійти</span></p>
    </div>

    <div id="mainSection" class="container hidden">
        <h1 id="welcomeText">Вітаємо!</h1>
        <p>Доступ до ресурсів DOMINO дозволено.</p>
        <div class="menu-grid">
            <button class="btn" onclick="showSection('news')">Новини</button>
            <button class="btn" onclick="showSection('profile')">Профіль</button>
            <button class="btn" onclick="showSection('team')">Партія</button>
            <button class="btn" onclick="showSection('support')">Підтримка</button>
        </div>
    </div>

    <div id="profileSection" class="container hidden" style="max-width: 700px;">
        <h2 style="font-size: 2em; margin-bottom: 20px;">Профіль <span id="profileNameHeader">User</span></h2>
        <div class="profile-layout">
            <div class="profile-left">
                <img src="https://via.placeholder.com/150" id="profileAvatarBig" alt="Avatar">
            </div>
            <div class="profile-right">
                <p><strong>Ім'я:</strong> <span id="profileName">User</span></p>
                <p><strong>Бали:</strong> <span id="profileScore">0</span></p>
                <p><strong>Партія:</strong> <span id="profileTeam">Не розподілено</span></p>
                <p><strong>Статус:</strong> <span style="color:green; font-weight:bold;">У системі</span></p>
                <div style="background: #f0f0f0; padding: 10px; border-radius: 8px; margin-top: 10px;">
                    <strong>Опис:</strong>
                    <p id="profileDescription" style="font-style: italic; color: #555;">(Немає опису)</p>
                </div>
            </div>
        </div>
        <br>
        <button onclick="showSection('main')" class="btn-back">Повернутися на головну</button>
    </div>

    <div id="newsSection" class="container hidden">
        <h2>Новини</h2>
        <p>Новин поки що немає.</p>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="teamSection" class="container hidden">
        <h2>Партія</h2>
        <p>Ваш статус у партії: <strong id="teamStatusText">Нов</strong></p>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="supportSection" class="container hidden">
        <h2>Підтримка та Ідеї</h2>
        <p>Маєте ідею для партії або знайшли помилку?</p>
        <textarea id="supportMessage" placeholder="Опишіть вашу ідею тут..." rows="5"></textarea>
        <button id="btnSupport" onclick="sendFeedback()">Відправити</button>
        <div id="supportStatus" class="status-msg"></div>
        <br><br>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="testsSection" class="container hidden">
        <h2>Доступні Тести</h2>
        <p>Виберіть завдання для виконання:</p>
        <div id="testsListContainer" class="menu-grid" style="grid-template-columns: 1fr;">
            <p>Завантаження...</p>
        </div>
        <br>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="adminSection" class="container hidden" style="border: 2px solid red;">
        <h2 style="color: red;">АА</h2>
        <div class="admin-tabs">
            <button onclick="document.getElementById('createTestForm').classList.toggle('hidden')">Конструктор Тестів</button>
            <br><br>
            <button onclick="loadUserManagement()" style="background: #333;">Всі Гості / Керування</button>
        </div>

        <div id="createTestForm" class="hidden" style="text-align: left; margin-top: 15px;">
            <h3>Нове запитання</h3>
            <label>Тип:</label>
            <select id="newQType">
                <option value="mandatory">Обовязковий (Блокує вхід)</option>
                <option value="optional">Звичайний (В меню Тести)</option>
            </select>
            <input type="text" id="newQText" placeholder="Текст запитання...">
            <p style="margin-bottom: 5px; font-weight: bold;">Фото (необов'язково):</p>
            <input type="file" id="newQFile" accept="image/*">
            <p id="uploadStatus" style="font-size: 0.8em; color: blue;"></p>
            <input type="hidden" id="uploadedImageUrl">
            <h4>Варіанти (Текст | Бали):</h4>
            <div id="answersContainer">
                <input type="text" class="ans-text" placeholder="Відповідь 1">
                <input type="number" class="ans-score" placeholder="Бали">
                <br>
                <input type="text" class="ans-text" placeholder="Відповідь 2">
                <input type="number" class="ans-score" placeholder="Бали">
            </div>
            <button onclick="addAnswerField()" style="background: grey; font-size: 0.8em;">+ Ще варіант</button>
            <hr>
            <button onclick="addToDraft()" style="background: orange; color: black; font-weight: bold;">Додати в список</button>
        </div>
        
        <div id="draftContainer" style="margin-top: 20px; border-top: 2px solid #ccc; padding-top: 10px;">
            <h3>Список питань:</h3>
            <div id="draftList" style="text-align: left; margin-bottom: 15px;"><p style="color: grey;">Пусто...</p></div>
            <button id="btnPublish" onclick="publishTest()" style="background: green; display: none;">ЗАВАНТАЖИТИ ВЕСЬ ТЕСТ</button>
        </div>
        <br>
        <button onclick="showSection('main')">Назад</button>
    </div>

    <div id="userListSection" class="container hidden" style="max-width: 600px;">
        <h2>Керування гос</h2>
        <div id="allUsersContainer" style="text-align: left;">
            <p>Завантаження...</p>
        </div>
        <br>
        <button onclick="showSection('admin')">Назад в А</button>
    </div>

    <div id="testPlayerSection" class="container hidden" style="max-width: 500px;">
        <img id="testImage" style="width: 100%; max-height: 250px; object-fit: contain; display: none; margin-bottom: 15px; border-radius: 8px;" referrerpolicy="no-referrer">
        <h2 id="testQuestionText">Запитання...</h2>
        <div id="testAnswers" class="menu-grid"></div>
        <p style="font-size: 0.8em; color: grey; margin-top: 10px;">Питання <span id="qCurrent">0</span> з <span id="qTotal">0</span></p>
    </div>

    <script src="script.js"></script>
</body>
</html>
